---
title: Εκκίνηση ρομπότ από το Cloud
contributors: [Fingerling42]
tools:   
  - Περιτύλιγμα Robonomics ROS 2 3.1.0
    https://github.com/airalab/robonomics-ros2/releases
---

**Σε αυτό το άρθρο, θα μάθετε πώς να χρησιμοποιήσετε τη λειτουργία εκκίνησης του Robonomics στο ROS 2 μέσω διαφόρων παραδειγμάτων**

Η κύρια λειτουργία της παρακαταθήκης Robonomics για την αποστολή εντολών σε συσκευές είναι η εξωτερική εκκίνηση. Αυτή η λειτουργία σάς επιτρέπει να στείλετε ένα string που περιέχει ένα παράμετρο (σε μορφή 32-byte μακρού δεκαεξαδικού αριθμού) σε μια συγκεκριμένη διεύθυνση εντός της παρακαταθήκης. Συνήθως, το string αντιπροσωπεύει ένα IPFS hash που δείχνει σε ένα αρχείο με τις απαραίτητες παραμέτρους για την εκτέλεση της εντολής. Μπορείτε να βρείτε περισσότερες λεπτομέρειες σχετικά με τη λειτουργία εκκίνησης [σε αυτό το άρθρο](https://wiki.robonomics.network/docs/launch/).

Στο Περιτύλιγμα Robonomics ROS 2, η λειτουργία εκκίνησης υλοποιείται ως ένας υπηρεσία για την αποστολή εντολών και ως ένα θέμα για τη λήψη εντολών.

## Αποστολή Εκκίνησης

Η υπηρεσία, που ονομάζεται `robonomics/send_launch`, φαίνεται ως εξής:

{% codeHelper { additionalLine: "RobonomicsROS2SendLaunch.srv"}%}

```YAML
string  param                   # Απλό string παράμετρος ή όνομα αρχείου με παραμέτρους που πρέπει να μεταφορτωθούν στο IPFS
string  target_address          # Διεύθυνση που θα ενεργοποιηθεί με την εκκίνηση
bool    is_file         True    # Είναι μια παράμετρος εκκίνησηςΈνα αρχείο που χρειάζεται να μεταφορτωθεί στο IPFS (προεπιλογή είναι True)?
bool    encrypt_status  True    # Ελέγξτε εάν το παράμετρο αρχείο χρειάζεται να κρυπτογραφηθεί με τη διεύθυνση στόχο, η προεπιλογή είναι True
---
string  launch_hash             # Κατακερματισμός της συναλλαγής εκκίνησης
```

{% endcodeHelper %}

Το σύστημα δέχεται τις ακόλουθες παραμέτρους ως μέρος του αιτήματος: μια παράμετρο εντολής (είτε απλή συμβολοσειρά είτε το όνομα ενός αρχείου που περιέχει τις παραμέτρους της εντολής), η διεύθυνση στόχος στο Robonomics parachain για την αποστολή της εκκίνησης και δύο σημαίες: μία που υποδηλώνει εάν η παράμετρος είναι ένα αρχείο και η άλλη προσδιορίζει εάν το αρχείο πρέπει να είναι κρυπτογραφημένο (και τα δύο έχουν οριστεί σε True από προεπιλογή). Το αρχείο θα μεταφορτωθεί στο IPFS, και ο κατακερματισμός του θα περάσει ως παράμετρος εκκίνησης. Συνεπώς, το αρχείο πρέπει να τοποθετηθεί στον κατάλογο που έχει οριστεί για τα αρχεία IPFS, όπως προσδιορίζεται στο αρχείο ρύθμισης για τον κόμβο `robonomics_ros2_pubsub`.

Από προεπιλογή, το αρχείο είναι κρυπτογραφημένο χρησιμοποιώντας τη δημόσια διεύθυνση του παραλήπτη της εκκίνησης. Η μέθοδος κρυπτογράφησης που εφαρμόζεται είναι η κρυπτογράφηση με δημόσιο κλειδί βασισμένη στην κρυπτογραφία καμπύλης ελλειπτικής καμπύλης Curve25519. Στην τρέχουσα υλοποίηση, η κρυπτογράφηση υποστηρίζεται μόνο για διευθύνσεις λογαριασμών του τύπου ED25519 (Edwards) (μπορείτε να διαβάσετε περισσότερα σχετικά με αυτό σε [αυτό το άρθρο](http://localhost:8080/docs/create-account-in-dapp/#22-create-account)).

Μετά την αποστολή της εκκίνησης, το σύστημα επιστρέφει τον κατακερματισμό της συναλλαγής.

## Λήψη Εκκίνησης

ΛήψηΟι εκκινήσεις οργανώνονται στη μορφή αντίστοιχου θέματος. Τεχνικά, το κόμβος χρησιμοποιεί τη λειτουργικότητα του διεπαφής robonomics-interface για να εγγραφεί στην κατάσταση της δικής του διεύθυνσης και περιμένει να εμφανιστεί το συμβάν `NewLaunch`. Μόλις συμβεί το συμβάν, ο κόμβος δημοσιεύει ένα μήνυμα στο θέμα `robonomics/received_launch`. Η μορφή του μηνύματος είναι η ακόλουθη:

{% codeHelper { additionalLine: "RobonomicsROS2ReceivedLaunch.msg"}%}

```YAML
string  launch_sender_address   # Διεύθυνση του λογαριασμού που έστειλε την εντολή εκκίνησης
string  param                   # Συμβολοσειρά με παράμετρο ή όνομα αρχείου με παραμέτρους
```

{% endcodeHelper %}

Τα πεδία του μηνύματος περιέχουν τη διεύθυνση από την οποία απεστάλη η εκκίνηση και την παράμετρο ή τον εαυτό της: είτε μια απλή συμβολοσειρά είτε το όνομα του αρχείου με τις παραμέτρους που κατέβηκε από το IPFS και τοποθετήθηκε στον κατάλογο εργασίας του IPFS. Εάν το αρχείο ήταν κρυπτογραφημένο, αποκρυπτογραφείται κατά τη διαδικασία αυτή.

## Παράδειγμα με Turtlesim

Στη συνέχεια, θα δείξουμε πώς να χρησιμοποιήσετε τη λειτουργία εκκίνησης με το [Turtlesim](https://docs.ros.org/en/humble/Tutorials/Beginner-CLI-Tools/Introducing-Turtlesim/Introducing-Turtlesim.html) ως παράδειγμα. Το Turtlesim είναι ένα ελαφρύ προσομοιωτή σχεδιασμένο για την εκμάθηση του ROS 2. Μπορείτε να το εγκαταστήσετε χρησιμοποιώντας την ακόλουθη εντολή:

{% codeHelper { copy: true}%}

```shell
sudo apt install ros-$ROS_DISTRO-turtlesim
```

{% endcodeHelper %}

Το πακέτο Robonomics ROS 2 Wrapper περιλαμβάνει ένα προεγκατεστημένο πακέτο με την ονομασία `turtlesim_robonomics`, το οποίο έχει προσαρμοστεί ειδικά για το Turtlesim. Αυτό το πακέτο σάς επιτρέπει να δοκιμάσετε όλες τις λειτουργίες του wrapper. Ας το δοκιμάσουμε και να το εκτελέσουμε.

{% roboWikiNote {type: "warning", title: "Προειδοποίηση"}%}

  Βεβαιωθείτε ότι έχετε επαρκές υπόλοιπο στον λογαριασμό σας ή ένα ενεργό συνδρομή για να πραγματοποιήσετε συναλλαγές.

{% endroboWikiNote %}

1. Για να ξεκινήσετε, δημιουργήστε ένα αρχείο ρύθμισης για την περίπτωση pubsub του `turtlesim_robonomics` χρησιμοποιώντας το πρότυπο `config/robonomics_pubsub_params_template.yaml`. Συμπληρώστε τα κατάλληλα πεδία με τα διαπιστευτήριά σας Robonomics (seed λογαριασμού, τύπο κρυπτογράφησης, διεύθυνση ιδιοκτήτη συνδρομής). Επίσης, καθορίστε έναν κατάλογο για τα αρχεία IPFS. Αφού ολοκληρώσετε, μετονομάστε το αρχείο, για παράδειγμα, `first_pubsub_params.yaml`.

2. Εκκινήστε τον IPFS Daemon:

{% codeHelper { copy: true}%}

```shell
ipfs daemon
```

{% endcodeHelper %}

3. Εκτελέστε το ακόλουθο αρχείο εκκίνησης ROS 2. Θα ξεκινήσει όλους τους απαραίτητους κόμβους: το Turtlesim ίδιο, την υλοποίηση του wrapper για το Turtlesim και το Robonomics pubsub:

{% codeHelper { copy: true}%}

```shell
ros2 launch turtlesim_robonomics turtlesim_robonomics_launch.py pubsub_params_path:=./first_pubsub_params
```.yaml namespace:='turtlesim1'
```

{% endcodeHelper %}

Θα δείτε τον προσομοιωτή με τη χελώνα, μαζί με τα αρχεία ROS 2 που εμφανίζονται στην κονσόλα εμφανίζοντας το ID του IPFS, τη διαδρομή προς τον κατάλογο με τα αρχεία IPFS, τη διεύθυνση Robonomics και άλλες σχετικές πληροφορίες.

### Εκκίνηση του Turtlesim από την πύλη του Polkadot

1. Το Turtlesim ελέγχεται μέσω του θέματος `/cmd_vel`, οπότε πρέπει να προετοιμάσετε τα αντίστοιχα μηνύματα και να τα συμπεριλάβετε σε ένα αρχείο, το οποίο θα χρησιμοποιηθεί ως παράμετρος εκκίνησης. Για την ευκολία, αυτά τα μηνύματα προετοιμάζονται σε ένα αρχείο JSON. Δημιουργήστε ένα αρχείο (π.χ. `turtle_cmd_vel.json`) και επικολλήστε τα παρακάτω:

  {% codeHelper { copy: true}%}

  ```json
  [
    {
       "linear": {
          "x": 5.0,
          "y": 0.0,
          "z": 0.0
       },
       "angular": {
          "x": 0.0,
          "y": 0.0,
          "z": 1.5
       }
    },
    {
       "linear": {
          "x": 2.0,
          "y": 0.0,
          "z": 0.0
       },
       "angular": {
          "x": 0.0,
          "y": 0.0,
          "z": 2.5
       }
```    }
  ]
  ```

  {% endcodeHelper %}

  Αυτό το παράδειγμα JSON θα εντολεύσει τη χελώνα να μετακινηθεί δύο φορές.

2. Στη συνέχεια, το αρχείο πρέπει να μεταφορτωθεί στο IPFS. Μπορείτε να επιλέξετε οποιαδήποτε μέθοδο, αλλά για αυτό το παράδειγμα, θα χρησιμοποιήσουμε το IPFS Kubo. Ανοίξτε ένα τερματικό στον κατάλογο όπου βρίσκεται το αρχείο JSON και μεταφορτώστε το στο IPFS:

  {% codeHelper { copy: true}%}

  ```shell
  ipfs add turtle_cmd_vel.json
  ```

  {% endcodeHelper %}

  Θα λάβετε το hash του αρχείου στο IPFS. Βεβαιωθείτε ότι το αποθηκεύετε για μετέπειτα χρήση.

3. Πριν στείλετε την εκκίνηση, το hash του IPFS πρέπει να μετατραπεί σε μια συμβολοσειρά μήκους 32 bytes. Αυτό μπορεί να γίνει χρησιμοποιώντας μερικές εντολές Python. Ανοίξτε ένα τερματικό, εκκινήστε τον διερμηνέα Python 3 και εκτελέστε τις παρακάτω εντολές:

  {% codeHelper { copy: true}%}

  ```python
  from robonomicsinterface.utils import ipfs_qm_hash_to_32_bytes
  ipfs_qm_hash_to_32_bytes('IPFS_FILE_HASH')
  ```

  {% endcodeHelper %}

  Αποθηκεύστε τη συμβολοσειρά που προκύπτει για μετέπειτα χρήση.

4. Ανοίξτε το Robonomics [Πύλη Polkadot/Substrate](https://polkadot.js.org/apps/?rpc=wss%3A%2F%2Fkusama.rpc.robonomics.network%2F#/extrinsics) και πλοηγηθείτεΜεταβείτε στην καρτέλα **Προγραμματιστές** -> **Εξωτερικά**. Επιλέξτε το εξωτερικό `launch` -> `launch(robot, param)`. Στο πεδίο `robot`, εισάγετε τη διεύθυνση του ρομπότ σας και στο πεδίο `param`, εισάγετε το string με το μετατραμένο IPFS hash. Υποβάλετε τη συναλλαγή.

5. Μεταβείτε στον προσομοιωτή Turtlesim. Αφού στείλετε με επιτυχία τη συναλλαγή, η χελώνα θα πρέπει να αρχίσει να κινείται.

### Εκκίνηση Turtlesim από τα Εργαλεία Εντολών ROS 2

1. Ας δοκιμάσουμε τώρα να στείλουμε μια εκκίνηση στο Turtlesim από έναν άλλο κόμβο pubsub του ROS 2. Πρώτα, δημιουργήστε έναν άλλο αρχείο ρυθμίσεων (π.χ., `second_pubsub_params.yaml`) με διαφορετικά διαπιστευτήρια Robonomics και έναν ξεχωριστό κατάλογο IPFS.

2. Σε έναν ξεχωριστό τερματικό, εκτελέστε έναν νέο κόμβο `robonomics_ros2_pubsub` χρησιμοποιώντας το νέο αρχείο ρυθμίσεων:

  {% codeHelper { copy: true}%}

  ```shell
  ros2 run robonomics_ros2_pubsub robonomics_ros2_pubsub --ros-args -r __ns:=/test -p pubsub_params_path:=./second_pubsub_params.yaml
  ```

  {% endcodeHelper %}

3. Τοποθετήστε το αρχείο JSON που περιέχει τις εντολές για το Turtlesim (`turtle_cmd_vel.json`) στον κατάλογο IPFS του νέου pubsub.

4. Πριν στείλετε την εκκίνηση, ας εγκαταστήσουμε παρακολούθηση για να παρατηρήσουμε πώς λαμβάνει το `turtlesim_robonomics`.Δεδομένα κατά την άφιξη. Για να το κάνετε αυτό, σε έναν ξεχωριστό τερματικό, εγγραφείτε στο αντίστοιχο θέμα:

{% codeHelper { copy: true}%}

  ```shell
  ros2 topic echo /turtlesim1/robonomics/received_launch
  ```

{% endcodeHelper %}

{% roboWikiNote {type: "warning", title: "Launch Param as String"}%}
Η παράμετρος εκκίνησης προσδοκά ένα hash IPFS ενός αρχείου από προεπιλογή. Αν χρειάζεστε το pubsub να χειριστεί την παράμετρο ως κανονική συμβολοσειρά, πρέπει να αλλάξετε την αντίστοιχη παράμετρο κόμβου ROS 2 `launch_is_ipfs` από `True` σε `False`. Μπορείτε να το κάνετε αυτό χρησιμοποιώντας την εντολή `ros2 param set`.

{% endroboWikiNote %}

5. Τώρα, πρέπει να καλέσουμε την υπηρεσία ROS 2 για να στείλουμε την εκκίνηση. Σε έναν ξεχωριστό τερματικό, χρησιμοποιήστε την ακόλουθη εντολή:

{% codeHelper { copy: true}%}

  ```shell
  ros2 service call /test/robonomics/send_launch robonomics_ros2_interfaces/srv/RobonomicsROS2SendLaunch {"param: 'turtle_cmd_vel.json', target_address: 'Η ΔΙΕΥΘΥΝΣΗ ΤΟΥ TURTLESIM ΣΑΣ'"}
  ```

{% endcodeHelper %}

Θα δείτε τα αρχεία καταγραφής pubsub να εμφανίζουν λεπτομέρειες της υποβολής της εκκίνησης.

6. Μεταβείτε στον προσομοιωτή Turtlesim. Αφού στείλετε με επιτυχία τη συναλλαγή, η χελώνα πρέπει να ξεκινήσει.Μετακίνηση. Επιπλέον, στα αρχεία καταγραφής του εγγεγραμμένου θέματος, θα πρέπει να βλέπετε πληροφορίες σχετικά με τα ληφθέντα δεδομένα.


### Εκκίνηση Turtlesim από Άλλο Κόμβο

1. Ας δοκιμάσουμε τώρα να δημιουργήσουμε έναν δοκιμαστικό κόμβο που θα περιμένει την εκκίνηση να φτάσει και στη συνέχεια θα την προωθήσει στο Turtlesim. Μπορείτε να χρησιμοποιήσετε το έτοιμο πακέτο δοκιμής `test_robot_robonomics`. Αντιγράψτε αυτό το πακέτο στον χώρο εργασίας ROS 2 σας.

2. Ανοίξτε το αρχείο κόμβου που βρίσκεται στη διαδρομή `test_robot_robonomics/test_robot_robonomics/test_robot_robonomics_node.py` σε οποιονδήποτε επεξεργαστή κειμένου και προσθέστε τον παρακάτω κώδικα μετά τη λειτουργία `__init__`:

  {% codeHelper { copy: true}%}

  ```python
  def launch_file_subscriber_callback(self, msg) -> None:
      super().launch_file_subscriber_callback(msg)

      transaction_hash = self.send_launch_request(self.param, target_address='Η ΔΙΕΥΘΥΝΣΗ ΤΟΥ TURTLESIM ΣΑΣ', is_file=True, encrypt_status=True)

      self.get_logger().info('Στάλθηκε εκκίνηση στη χελώνα με hash: %s ' % str(transaction_hash))
  ```

  {% endcodeHelper %}

  Αυτή η λειτουργία θα επεξεργαστεί πρώτα την ληφθείσα εκκίνηση και στη συνέχεια θα χρησιμοποιήσει την παράμετρό της για να στείλει μια νέα εκκίνηση στο Turtlesim.

3. Κατασκευάστε το πακέτο χρησιμοποιώντας το `colcon`, και στη συνέχεια πηγαίνετε στα αρχεία ρύθμισης του.

4. Εκτελέστε το αρχείο εκκίνησης ROS 2 του πακέτου δοκιμής με τα δεύτερα διαπιστευτήρια pubsub:

{% codeHelper { copy: true}%} 

  ```shell
  ros2 launch test_robot_robonomics test_robot_robonomics_launch.py pubsub_params_path:=./second_pubsub_params.yaml namespace:='test'
  ```

{% endcodeHelper %}

5. Τώρα, στείλτε ένα λανσάρισμα με τις παραμέτρους `turtle_cmd_vel.json` στη διεύθυνση του κόμβου δοκιμής, για παράδειγμα, μέσω της πύλης Polkadot/Substrate. Πριν το κάνετε αυτό, βεβαιωθείτε ότι το Turtlesim εξακολουθεί να λειτουργεί. Ο κόμβος δοκιμής θα πρέπει να λάβει το λανσάρισμα και στη συνέχεια να στείλει ένα νέο με τις ίδιες παραμέτρους, προκαλώντας την κίνηση της χελώνας στο Turtlesim.